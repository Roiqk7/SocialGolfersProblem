# AI Generated

name: Python Tests

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: ["3.11"]

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v5
      with:
        python-version: ${{ matrix.python-version }}
        
    - name: Install C++ build tools (for Glucose) üõ†Ô∏è
      run: |
        sudo apt-get update
        # Install build-essential (g++ and make) and zlib1g-dev (Glucose dependency)
        sudo apt-get install -y build-essential zlib1g-dev

    - name: Build Glucose SAT Solver (Revised) üß©
      run: |
        # 1. Ensure the directory structure exists
        mkdir -p glucose/simp
        cd glucose/simp
        
        # 2. Download the source code
        wget -q https://www.labri.fr/perso/lsimon/research/glucose/glucose-syrup-4.1.tgz
        
        # 3. Extract contents directly into 'simp'
        tar -xzf glucose-syrup-4.1.tgz
        
        # 4. Move contents up one level to simplify the build path
        mv glucose-syrup-4.1/* .
        rm -r glucose-syrup-4.1 glucose-syrup-4.1.tgz
        
        # 5. Compile the solver. We use the 'simple' target which often works better.
        # This should create the 'glucose' executable in the current directory (glucose/simp)
        make simple 
        
        # 6. Verify the executable exists
        if [ ! -f "glucose" ]; then
          echo "ERROR: Glucose executable not found after compilation!"
          exit 1
        fi
        
        # Go back to the repository root
        cd ../..

    - name: Install Python dependencies
      run: |
        python -m pip install --upgrade pip
        pip install coloredlogs 
        # TODO: If you create a requirements.txt, you can uncomment the line below:
        # pip install -r requirements.txt

    - name: Run tests with unittest/pytest
      # Uses the built-in unittest discover command to find tests in src/core/test.py
      run: |
        python -m unittest discover -s src/core -p "test.py"
